---
source: https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#Jdk%E7%9B%AE%E5%BD%95
---
openJdk1.8中的makefile，记录下java的执行文件编译过程及jvm编译过程。

## [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#%E7%9B%AE%E5%BD%95%E8%AF%B4%E6%98%8E)目录说明

openjdk源码中有很多目录，根据功能做了模块化划分，每个目录实现其相应的功能。  
每个目录下的结构都差不多，分为src(源码)、make(makefile)、test(或没有)、其他特殊目录。

-   openjdk

-   common 一些公共文件，比如下载源码的shell脚本、生成make的autoconf等文件
-   corba 分布式通讯接口
-   hotspot 虚拟机实现
-   jaxp xml处理代码
-   jaxws ws实现api
-   jdk jdk源码
-   langtools java语言工具实现，比如javac、javap等
-   make make文件
-   nashorn java中js的运行时实现
-   test 测试文件

### [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#Jdk%E7%9B%AE%E5%BD%95)Jdk目录

#### [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#%E7%9B%AE%E5%BD%95)目录

-   jdk
    -   src 源码目录
        -   bsd bsd实现
        -   linux linux实现
        -   macosx macos实现
        -   share 公用代码，linux平台代码会在这里
        -   solaris solaris实现
        -   windows window实现
    -   make makefile
    -   test 单元测试文件

### [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#langtools%E7%9B%AE%E5%BD%95)langtools目录

该目录主要实现了jdk提供的基于jvm的工具，比如:java, javac, javah, javap等。

#### [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#%E7%9B%AE%E5%BD%95-1)目录

-   langtools

-   src 源码目录
    -   share java源代码
        -   bin 模板
        -   classes java源码文件
            -   com 存放了java提供的一些基础类实现,打包成tools.jar
            -   javax
            -   jdk
        -   sample 样例源码
-   make makefile目录
-   test 测试用例目录

## [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#Makefile%E7%9B%AE%E6%A0%87%E7%94%9F%E6%88%90)Makefile目标生成

### [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%BC%96%E8%AF%91Makefile)可执行文件编译Makefile

文件名为：/openjdk/jdk/make/CompileLaunchers.gmk  
java中提供的bin目录下的java、javac、javap等都不是完全通过c/c++编写实现的，是通过c/c++入口，启动虚拟机加载class文件实现的相关功能。  
通过c/c++的main函数入口，创建jvm虚拟机后，通过执行相关功能的java代码实现其功能，所以java相关的功能如编译、运行、查看jvm信息等功能都是通过启动一个jvm虚拟机或者通过jvmti等实现的。

在makefile文件中可以查看到该部分定义。

<table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br></pre></td><td><pre><span><span>ifndef</span> BUILD_HEADLESS_ONLY</span><br><span>  <span>$(<span>eval</span> $(<span>call</span> SetupLauncher,appletviewer, \</span></span><br><span><span>      -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "sun.applet.Main"<span>$(COMMA)</span> }',, \</span></span><br><span><span>      <span>$(XLIBS)</span>)</span>)</span><br><span><span>endif</span></span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,extcheck, \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "com.sun.tools.extcheck.Main"<span>$(COMMA)</span> }')</span>)</span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,idlj, \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "com.sun.tools.corba.se.idl.toJavaPortable.Compile"<span>$(COMMA)</span> }')</span>)</span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,jar, \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "sun.tools.jar.Main"<span>$(COMMA)</span> }')</span>)</span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,jarsigner, \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "sun.security.tools.jarsigner.Main"<span>$(COMMA)</span> }')</span>)</span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,javac, \</span></span><br><span><span>    -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span><span>    -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "com.sun.tools.javac.Main"<span>$(COMMA)</span> }')</span>)</span><br><span></span><br><span><span>ifeq</span> (<span>$(ENABLE_SJAVAC)</span>, yes)</span><br><span>  <span>$(<span>eval</span> $(<span>call</span> SetupLauncher,sjavac, \</span></span><br><span><span>      -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span><span>      -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span><span>      -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "com.sun.tools.sjavac.Main"<span>$(COMMA)</span> }')</span>)</span><br><span><span>endif</span></span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,javadoc, \</span></span><br><span><span>    -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span><span>    -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "com.sun.tools.javadoc.Main"<span>$(COMMA)</span> }')</span>)</span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,javah, \</span></span><br><span><span>    -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span><span>    -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "com.sun.tools.javah.Main"<span>$(COMMA)</span> }')</span>)</span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,javap, \</span></span><br><span><span>    -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span><span>    -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "com.sun.tools.javap.Main"<span>$(COMMA)</span> }')</span>)</span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,jdeps, \</span></span><br><span><span>    -DEXPAND_CLASSPATH_WILDCARDS \</span></span><br><span><span>    -DNEVER_ACT_AS_SERVER_CLASS_MACHINE \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "com.sun.tools.jdeps.Main"<span>$(COMMA)</span> }')</span>)</span><br><span></span><br><span>BUILD_LAUNCHER_jconsole_CFLAGS_windows := -DJAVAW</span><br><span>BUILD_LAUNCHER_jconsole_LDFLAGS_windows := user32.lib</span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,jconsole, \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "-J-Djconsole.showOutputViewer"<span>$(COMMA)</span> "sun.tools.jconsole.JConsole"<span>$(COMMA)</span> }' \</span></span><br><span><span>    -DAPP_CLASSPATH='{ "/lib/jconsole.jar"<span>$(COMMA)</span> "/lib/tools.jar"<span>$(COMMA)</span> "/classes" }')</span>)</span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,jdb, \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "com.sun.tools.example.debug.tty.TTY"<span>$(COMMA)</span> }' \</span></span><br><span><span>    -DAPP_CLASSPATH='{ "/lib/tools.jar"<span>$(COMMA)</span> "/lib/sa-jdi.jar"<span>$(COMMA)</span> "/classes" }')</span>)</span><br><span></span><br><span><span>$(<span>eval</span> $(<span>call</span> SetupLauncher,jhat, \</span></span><br><span><span>    -DJAVA_ARGS='{ "-J-ms8m"<span>$(COMMA)</span> "com.sun.tools.hat.Main"<span>$(COMMA)</span> }')</span>)</span><br></pre></td></tr></tbody></table>

具体各个具体功能实现可以由makefile中找到相关的类文件查看实现。  
这些类在目录langtools目录中。

在linux上编译openjdk的时候，所有java提供的工具程序(bin目录下的可执行程序)入口都是jdk/src/bin/share/bin/main.c。但是具体的功能代码实现其实是在langtools下通过java代码实现的，到底是怎么是怎么实现的呢。  
1、在jdk/src/share/bin/defines.h中通过宏开关实现了jvm虚拟机执行参数的定义，如下：

<table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br></pre></td><td><pre><span>#如果定义了JAVA_ARGS宏，则会把jvm的参数从宏定义中获取</span><br><span># 此处参照/openjdk/jdk/make/CompileLaunchers.gmk文件在声明javac的地方，定义了该宏内容</span><br><span># -DJAVA_ARGS=<span>'{ "-J-ms8m"$(COMMA) "com.sun.tools.javac.Main"$(COMMA) }'</span>))，所以生成的elf文件javac中</span><br><span># 会得到该值为{ <span>"-J-ms8m"</span>$(COMMA) <span>"com.sun.tools.javac.Main"</span>$(COMMA) }</span><br><span><span>#<span>ifdef</span> JAVA_ARGS</span></span><br><span><span>static</span> <span>const</span> <span>char</span>* const_progname = <span>"java"</span>;</span><br><span><span>static</span> <span>const</span> <span>char</span>* const_jargs[] = JAVA_ARGS;</span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span><span>#<span>ifndef</span> APP_CLASSPATH</span></span><br><span><span>#<span>define</span> APP_CLASSPATH        { <span>"/lib/tools.jar"</span>, <span>"/classes"</span> }</span></span><br><span><span>#<span>endif</span> </span></span><br><span><span>static</span> <span>const</span> <span>char</span>* const_appclasspath[] = APP_CLASSPATH;</span><br><span><span>#<span>else</span>  </span></span><br><span><span>#<span>ifdef</span> PROGNAME</span></span><br><span><span>static</span> <span>const</span> <span>char</span>* const_progname = PROGNAME;</span><br><span><span>#<span>else</span></span></span><br><span><span>static</span> <span>char</span>* const_progname = <span>NULL</span>;</span><br><span><span>#<span>endif</span></span></span><br><span><span>static</span> <span>const</span> <span>char</span>** const_jargs = <span>NULL</span>;</span><br><span><span>static</span> <span>const</span> <span>char</span>** const_appclasspath = <span>NULL</span>;</span><br><span><span>#<span>endif</span> </span></span><br><span></span><br><span><span>#<span>ifdef</span> LAUNCHER_NAME</span></span><br><span><span>static</span> <span>const</span> <span>char</span>* const_launcher = LAUNCHER_NAME;</span><br><span><span>#<span>else</span>  </span></span><br><span><span>static</span> <span>char</span>* const_launcher = <span>NULL</span>;</span><br><span><span>#<span>endif</span> </span></span><br><span></span><br><span><span>#<span>ifdef</span> EXPAND_CLASSPATH_WILDCARDS</span></span><br><span><span>static</span> <span>const</span> jboolean const_cpwildcard = JNI_TRUE;</span><br><span><span>#<span>else</span></span></span><br><span><span>static</span> <span>const</span> jboolean const_cpwildcard = JNI_FALSE;</span><br><span><span>#<span>endif</span> </span></span><br><span></span><br><span><span>#<span>if</span> defined(NEVER_ACT_AS_SERVER_CLASS_MACHINE)</span></span><br><span><span>static</span> <span>const</span> jint const_ergo_class = NEVER_SERVER_CLASS;</span><br><span><span>#<span>elif</span> defined(ALWAYS_ACT_AS_SERVER_CLASS_MACHINE)</span></span><br><span><span>static</span> <span>const</span> jint const_ergo_class = ALWAYS_SERVER_CLASS;</span><br><span><span>#<span>else</span></span></span><br><span><span>static</span> <span>const</span> jint const_ergo_class = DEFAULT_POLICY;</span><br><span><span>#<span>endif</span> </span></span><br></pre></td></tr></tbody></table>

最终生成的elf程序常量区段会有程序名称及入口的class类名称。

当使用javac编译java文件时，入口参数1为java文件路径，然后启动一个java虚拟机vm，把com.sun.tools.javac.Main aaa.java传递给  
java虚拟机vm执行，传递给虚拟机参数如下：

<table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br></pre></td><td><pre><span><span>JavaVM</span> args:</span><br><span>    <span>version</span> <span>0</span>x<span>00010002</span>, ignoreUnrecognized is JNI_FALSE, nOptions is <span>7</span></span><br><span>    <span>option</span>[<span>0</span>] = '-Dsun.java.launcher.diag=true'</span><br><span>    <span>option</span>[<span>1</span>] = '-Dapplication.home=/opt/source/jdk<span>8</span>u-dev/build/linux-x<span>86</span>_<span>64</span>-normal-server-slowdebug/jdk'</span><br><span>    <span>option</span>[<span>2</span>] = '-Djava.class.path=/opt/source/jdk<span>8</span>u-dev/build/linux-x<span>86</span>_<span>64</span>-normal-server-slowdebug/jdk/lib/tools.jar:/opt/source/jdk<span>8</span>u-dev/build/linux-x<span>86</span>_<span>64</span>-normal-server-slowdebug/jdk/classes'</span><br><span>    <span>option</span>[<span>3</span>] = '-Xms<span>8</span>m'</span><br><span>    <span>option</span>[<span>4</span>] = '-Dsun.java.command=com.sun.tools.javac.Main aaa.java'</span><br><span>    <span>option</span>[<span>5</span>] = '-Dsun.java.launcher=SUN_STANDARD'</span><br><span>    <span>option</span>[<span>6</span>] = '-Dsun.java.launcher.pid=<span>5997</span>'</span><br></pre></td></tr></tbody></table>

### [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#jar%E5%8C%85%E7%94%9F%E6%88%90)jar包生成

jdk编译后会生成很多jar包，除了jvm虚拟机提供的一些平台功能外，其他语言层面的功能都是由java开发的jar包对外提供的，所以现在有很多语言都基于jvm做了实现。  
openjdk提供了由运行时rt.jar, 工具tools.jar，编码charset.jar等其他功能jar。  
下面详细介绍几个重要的jar包是怎么生成的。

#### [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#tools-jar%E5%8C%85)tools.jar包

tools.jar包在jdk的lib目录下，主要提供jdk/bin目录下java工具的虚拟机里面的实现代码，由java开发。  
生成tools.jar包的makefile文件是：文件名为：/openjdk/jdk/make/CreateJars.gmk，内容如下：

源码路径：langtools目录

<table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br></pre></td><td><pre><span>#声明tools包含的目录范围</span><br><span>TOOLS_JAR_INCLUDES := \</span><br><span>    com<span>/sun/</span>codemodel \</span><br><span>    com<span>/sun/i</span>stack<span>/internal/</span>tools \</span><br><span>    com<span>/sun/</span>jarsigner \</span><br><span>    com<span>/sun/</span>javadoc \</span><br><span>    com<span>/sun/</span>jdi \</span><br><span>    com<span>/sun/</span><span>source</span> \</span><br><span>    com<span>/sun/</span>tools/attach \</span><br><span>    com<span>/sun/</span>tools/classfile \</span><br><span>    com<span>/sun/</span>tools/corba \</span><br><span>    com<span>/sun/</span>tools/doclets \</span><br><span>    com<span>/sun/</span>tools/doclint \</span><br><span>    com<span>/sun/</span>tools<span>/example/</span>debug/expr \</span><br><span>    com<span>/sun/</span>tools<span>/example/</span>debug/tty \</span><br><span>    com<span>/sun/</span>tools/extcheck \</span><br><span>    com<span>/sun/</span>tools/hat \</span><br><span>    com<span>/sun/</span>tools<span>/internal/</span>jxc \</span><br><span>    com<span>/sun/</span>tools<span>/internal/</span>jxc/ap \</span><br><span>    com<span>/sun/</span>tools<span>/internal/</span>ws \</span><br><span>    com<span>/sun/</span>tools<span>/internal/</span>ws<span>/wscompile/</span>plugin/at_generated \</span><br><span>    com<span>/sun/</span>tools<span>/internal/</span>xjc \</span><br><span>    com<span>/sun/</span>tools/javac \</span><br><span>    com<span>/sun/</span>tools/javadoc \</span><br><span>    com<span>/sun/</span>tools/javah \</span><br><span>    com<span>/sun/</span>tools/javap \</span><br><span>    com<span>/sun/</span>tools/jdeps \</span><br><span>    com<span>/sun/</span>tools/jdi \</span><br><span>    com<span>/sun/</span>tools<span>/script/</span>shell \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>dtdparser \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>rngom \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>xsom \</span><br><span>    org<span>/relaxng/</span>datatype \</span><br><span>    sun/applet \</span><br><span>    sun/jvmstat \</span><br><span>    sun<span>/rmi/</span>rmic \</span><br><span>    sun<span>/security/</span>tools/jarsigner \</span><br><span>    sun<span>/tools/</span>asm \</span><br><span>    sun<span>/tools/</span>attach \</span><br><span>    sun<span>/tools/</span>jar \</span><br><span>    sun<span>/tools/</span>java \</span><br><span>    sun<span>/tools/</span>javac \</span><br><span>    sun<span>/tools/</span>jcmd \</span><br><span>    sun<span>/tools/</span>jinfo \</span><br><span>    sun<span>/tools/</span>jmap \</span><br><span>    sun<span>/tools/</span>jps \</span><br><span>    sun<span>/tools/</span>jstack \</span><br><span>    sun<span>/tools/</span>jstat \</span><br><span>    sun<span>/tools/</span>jstatd \</span><br><span>    sun<span>/tools/</span>native2ascii \</span><br><span>    sun<span>/tools/</span>serialver \</span><br><span>    sun<span>/tools/</span>tree \</span><br><span>    sun<span>/tools/u</span>til</span><br><span></span><br><span># tools.jar排除sjavac工具</span><br><span># The sjavac tools is not ready <span>for</span> <span>public</span> consumption.</span><br><span>TOOLS_JAR_EXCLUDES = com<span>/sun/</span>tools/sjavac</span><br><span></span><br><span>#调用打包生成tools.jar文件</span><br><span>$(eval $(<span>call</span> SetupArchive,BUILD_TOOLS_JAR, , \</span><br><span>    SRCS := $(JDK_OUTPUTDIR)/classes, \</span><br><span>    SUFFIXES := .<span>class</span> .prp .gif .properties .xml .css .xsd .js .html .txt .java \</span><br><span>        Tool aliasmap <span>options</span>, \</span><br><span>    <span>INCLUDES</span> := $(TOOLS_JAR_INCLUDES), \</span><br><span>    EXCLUDES := $(TOOLS_JAR_EXCLUDES), \</span><br><span>    EXTRA_FILES := META-INF<span>/services/</span>com.sun.jdi.connect.Connector \</span><br><span>        META-INF<span>/services/</span>com.sun.jdi.connect.spi.TransportService \</span><br><span>        META-INF<span>/services/</span>com.sun.tools.attach.spi.AttachProvider \</span><br><span>        META-INF<span>/services/</span>com.sun.tools.internal.ws.wscompile.Plugin \</span><br><span>        META-INF<span>/services/</span>com.sun.tools.internal.xjc.Plugin, \</span><br><span>    JAR := $(IMAGES_OUTPUTDIR)<span>/lib/</span>tools.jar, \</span><br><span>    SKIP_METAINF := <span>true</span>, \</span><br><span>    CHECK_COMPRESS_JAR := <span>true</span>))</span><br></pre></td></tr></tbody></table>

#### [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#rt-jar%E5%8C%85)rt.jar包

rt.jar包在jdk的lib目录下，主要提供java语言层面的运行时库，由java开发。  
rt.jar包含的文件范围由:/openjdk/jdk/make/profile-rtjar-includes.txt定义，内容如下:

<table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br><span>105</span><br><span>106</span><br><span>107</span><br><span>108</span><br><span>109</span><br><span>110</span><br><span>111</span><br><span>112</span><br><span>113</span><br><span>114</span><br><span>115</span><br><span>116</span><br><span>117</span><br><span>118</span><br><span>119</span><br><span>120</span><br><span>121</span><br><span>122</span><br><span>123</span><br><span>124</span><br><span>125</span><br><span>126</span><br><span>127</span><br><span>128</span><br><span>129</span><br><span>130</span><br><span>131</span><br><span>132</span><br><span>133</span><br><span>134</span><br><span>135</span><br><span>136</span><br><span>137</span><br><span>138</span><br><span>139</span><br><span>140</span><br><span>141</span><br><span>142</span><br><span>143</span><br><span>144</span><br><span>145</span><br><span>146</span><br><span>147</span><br><span>148</span><br><span>149</span><br><span>150</span><br><span>151</span><br><span>152</span><br><span>153</span><br><span>154</span><br><span>155</span><br><span>156</span><br><span>157</span><br><span>158</span><br><span>159</span><br><span>160</span><br><span>161</span><br><span>162</span><br><span>163</span><br><span>164</span><br><span>165</span><br><span>166</span><br><span>167</span><br><span>168</span><br><span>169</span><br><span>170</span><br><span>171</span><br><span>172</span><br><span>173</span><br><span>174</span><br><span>175</span><br><span>176</span><br><span>177</span><br><span>178</span><br><span>179</span><br><span>180</span><br><span>181</span><br><span>182</span><br><span>183</span><br><span>184</span><br><span>185</span><br><span>186</span><br><span>187</span><br><span>188</span><br><span>189</span><br><span>190</span><br><span>191</span><br><span>192</span><br><span>193</span><br><span>194</span><br><span>195</span><br><span>196</span><br><span>197</span><br><span>198</span><br><span>199</span><br><span>200</span><br><span>201</span><br><span>202</span><br><span>203</span><br><span>204</span><br><span>205</span><br><span>206</span><br><span>207</span><br><span>208</span><br><span>209</span><br><span>210</span><br><span>211</span><br><span>212</span><br><span>213</span><br><span>214</span><br><span>215</span><br><span>216</span><br><span>217</span><br><span>218</span><br><span>219</span><br><span>220</span><br><span>221</span><br><span>222</span><br><span>223</span><br><span>224</span><br><span>225</span><br><span>226</span><br><span>227</span><br><span>228</span><br><span>229</span><br><span>230</span><br><span>231</span><br><span>232</span><br><span>233</span><br><span>234</span><br><span>235</span><br><span>236</span><br><span>237</span><br><span>238</span><br><span>239</span><br><span>240</span><br><span>241</span><br><span>242</span><br><span>243</span><br><span>244</span><br><span>245</span><br><span>246</span><br><span>247</span><br><span>248</span><br><span>249</span><br><span>250</span><br><span>251</span><br><span>252</span><br><span>253</span><br><span>254</span><br><span>255</span><br><span>256</span><br></pre></td><td><pre><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span></span><br><span>PROFILE_1_RTJAR_INCLUDE_PACKAGES := \</span><br><span>    com<span>/sun/</span>demo<span>/jvmti/</span>hprof \</span><br><span>    com<span>/sun/</span>java<span>/util/</span>jar/pack \</span><br><span>    com<span>/sun/</span>net/ssl \</span><br><span>    com<span>/sun/</span>nio/file \</span><br><span>    com<span>/sun/</span>security<span>/cert/i</span>nternal/x509 \</span><br><span>    java/io \</span><br><span>    java/lang \</span><br><span>    java/math \</span><br><span>    java/net \</span><br><span>    java/nio \</span><br><span>    java/security \</span><br><span>    java/text \</span><br><span>    java/time \</span><br><span>    java/util \</span><br><span>    javax/net \</span><br><span>    javax/script \</span><br><span>    javax/security \</span><br><span>    jdk \</span><br><span>    sun/invoke \</span><br><span>    sun/launcher \</span><br><span>    sun/misc \</span><br><span>    sun<span>/net/</span> \</span><br><span>    sun/nio \</span><br><span>    sun/reflect \</span><br><span>    sun/security \</span><br><span>    sun/text \</span><br><span>    sun/usagetracker \</span><br><span>    sun/util</span><br><span></span><br><span>PROFILE_1_RTJAR_INCLUDE_TYPES :=</span><br><span></span><br><span>PROFILE_1_RTJAR_EXCLUDE_TYPES :=</span><br><span></span><br><span>PROFILE_1_INCLUDE_METAINF_SERVICES :=</span><br><span></span><br><span></span><br><span>PROFILE_2_RTJAR_INCLUDE_PACKAGES := \</span><br><span>    com<span>/sun/</span>java_cup<span>/internal/</span>runtime \</span><br><span>    com<span>/sun/</span>net/httpserver \</span><br><span>    com<span>/sun/</span>org/apache \</span><br><span>    com<span>/sun/</span>rmi/rmid \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>stream \</span><br><span>    java/rmi \</span><br><span>    java/sql \</span><br><span>    javax<span>/rmi/</span>ssl \</span><br><span>    javax/sql \</span><br><span>    javax/transaction \</span><br><span>    javax/xml \</span><br><span>    org/w3c \</span><br><span>    org<span>/xml/</span>sax \</span><br><span>    sun<span>/net/</span>httpserver \</span><br><span>    sun/rmi \</span><br><span>    sun<span>/util/</span>xml</span><br><span></span><br><span>PROFILE_2_RTJAR_INCLUDE_TYPES :=</span><br><span></span><br><span>PROFILE_2_RTJAR_EXCLUDE_TYPES :=</span><br><span></span><br><span>PROFILE_2_INCLUDE_METAINF_SERVICES := \</span><br><span>    META-INF<span>/services/</span>sun.util.spi.XmlPropertiesProvider</span><br><span></span><br><span></span><br><span>PROFILE_3_RTJAR_INCLUDE_PACKAGES := \</span><br><span>    com<span>/sun/</span>jmx \</span><br><span>    com<span>/sun/</span>jndi \</span><br><span>    com<span>/sun/m</span>anagement \</span><br><span>    com<span>/sun/</span>naming/internal \</span><br><span>    com<span>/sun/</span>nio/sctp \</span><br><span>    com<span>/sun/</span>org<span>/apache/</span>xml<span>/internal/</span>security \</span><br><span>    com<span>/sun/</span>rowset \</span><br><span>    com<span>/sun/</span>security/auth \</span><br><span>    com<span>/sun/</span>security/jgss \</span><br><span>    com<span>/sun/</span>security/ntlm \</span><br><span>    com<span>/sun/</span>security/sasl \</span><br><span>    com<span>/sun/</span>tracing \</span><br><span>    java<span>/lang/i</span>nstrument \</span><br><span>    java<span>/lang/m</span>anagement \</span><br><span>    java<span>/security/</span>acl \</span><br><span>    java<span>/util/</span>prefs \</span><br><span>    javax<span>/annotation/</span>processing \</span><br><span>    javax<span>/lang/m</span>odel \</span><br><span>    javax/management \</span><br><span>    javax/naming \</span><br><span>    javax<span>/security/</span>auth/kerberos \</span><br><span>    javax<span>/security/</span>sasl \</span><br><span>    javax/smartcardio \</span><br><span>    javax<span>/sql/</span>rowset \</span><br><span>    javax/tools \</span><br><span>    javax<span>/xml/</span>crypto \</span><br><span>    org<span>/ietf/</span>jgss \</span><br><span>    org<span>/jcp/</span>xml \</span><br><span>    sun/instrument \</span><br><span>    sun/management \</span><br><span>    sun<span>/net/</span>dns \</span><br><span>    sun<span>/net/</span>www<span>/protocol/</span>http/ntlm \</span><br><span>    sun<span>/net/</span>www<span>/protocol/</span>http/spnego \</span><br><span>    sun<span>/nio/</span>ch/sctp \</span><br><span>    sun<span>/security/</span>acl \</span><br><span>    sun<span>/security/</span>jgss \</span><br><span>    sun<span>/security/</span>krb5 \</span><br><span>    sun<span>/security/</span>provider<span>/certpath/</span>ldap \</span><br><span>    sun<span>/security/</span>smartcardio \</span><br><span>    sun/tracing</span><br><span></span><br><span>PROFILE_3_RTJAR_INCLUDE_TYPES :=</span><br><span></span><br><span>PROFILE_3_RTJAR_EXCLUDE_TYPES := \</span><br><span>    com<span>/sun/</span>security<span>/auth/</span>callback/DialogCallbackHandler$<span>$1</span>.class \</span><br><span>    com<span>/sun/</span>security<span>/auth/</span>callback/DialogCallbackHandler$<span>$2</span>.class \</span><br><span>    com<span>/sun/</span>security<span>/auth/</span>callback/DialogCallbackHandler$<span>$Action</span>.class \</span><br><span>    com<span>/sun/</span>security<span>/auth/</span>callback/DialogCallbackHandler$<span>$ConfirmationInfo</span>.class \</span><br><span>    com<span>/sun/</span>security<span>/auth/</span>callback/DialogCallbackHandler.class \</span><br><span>    javax<span>/management/</span>remote<span>/rmi/</span>_RMIConnectionImpl_Tie.class \</span><br><span>    javax<span>/management/</span>remote<span>/rmi/</span>_RMIConnection_Stub.class \</span><br><span>    javax<span>/management/</span>remote<span>/rmi/</span>_RMIServerImpl_Tie.class \</span><br><span>    javax<span>/management/</span>remote<span>/rmi/</span>_RMIServer_Stub.class</span><br><span></span><br><span>FULL_JRE_RTJAR_INCLUDE_PACKAGES := \</span><br><span>    com/oracle \</span><br><span>    com<span>/sun/</span>accessibility<span>/internal/</span>resources \</span><br><span>    com<span>/sun/</span>activation/registries \</span><br><span>    com<span>/sun/</span>awt \</span><br><span>    com<span>/sun/</span>beans \</span><br><span>    com<span>/sun/</span>corba \</span><br><span>    com<span>/sun/im</span>age<span>/codec/</span>jpeg \</span><br><span>    com<span>/sun/im</span>ageio \</span><br><span>    com<span>/sun/i</span>stack \</span><br><span>    com<span>/sun/</span>java/browser \</span><br><span>    com<span>/sun/</span>java/swing \</span><br><span>    com<span>/sun/</span>jmx<span>/remote/</span>protocol/iiop \</span><br><span>    com<span>/sun/</span>jndi/cosnaming \</span><br><span>    com<span>/sun/</span>jndi<span>/toolkit/</span>corba \</span><br><span>    com<span>/sun/</span>jndi<span>/url/</span>corbaname \</span><br><span>    com<span>/sun/</span>jndi<span>/url/ii</span>op \</span><br><span>    com<span>/sun/</span>jndi<span>/url/ii</span>opname \</span><br><span>    com<span>/sun/m</span>edia/sound \</span><br><span>    com<span>/sun/</span>org/glassfish \</span><br><span>    com<span>/sun/</span>org/omg \</span><br><span>    com<span>/sun/</span>swing \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>bind \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>fastinfoset \</span><br><span>    com<span>/sun/</span>xml<span>/internal/m</span>essaging \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>org \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>stream/buffer \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>txw2 \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>ws \</span><br><span>    java/applet \</span><br><span>    java/awt \</span><br><span>    java/beans \</span><br><span>    javax/accessibility \</span><br><span>    javax/activation \</span><br><span>    javax/activity \</span><br><span>    javax/imageio \</span><br><span>    javax/jws \</span><br><span>    javax/print \</span><br><span>    javax<span>/rmi/</span>CORBA \</span><br><span>    javax/sound \</span><br><span>    javax/swing \</span><br><span>    javax<span>/xml/</span>bind \</span><br><span>    javax<span>/xml/</span>soap \</span><br><span>    javax<span>/xml/</span>ws \</span><br><span>    org/omg \</span><br><span>    sun/applet \</span><br><span>    sun/audio \</span><br><span>    sun/awt \</span><br><span>    sun/corba \</span><br><span>    sun/dc \</span><br><span>    sun/font \</span><br><span>    sun/java2d \</span><br><span>    sun<span>/net/</span>ftp \</span><br><span>    sun<span>/net/</span>smtp \</span><br><span>    sun<span>/net/</span>www<span>/content/</span>audio \</span><br><span>    sun<span>/net/</span>www<span>/content/im</span>age \</span><br><span>    sun<span>/net/</span>www<span>/content/</span>text \</span><br><span>    sun<span>/net/</span>www<span>/protocol/</span>ftp \</span><br><span>    sun<span>/net/</span>www<span>/protocol/m</span>ailto \</span><br><span>    sun<span>/net/</span>www<span>/protocol/</span>netdoc \</span><br><span>    sun/print \</span><br><span>    sun<span>/security/</span>tools/policytool \</span><br><span>    sun/swing \</span><br><span>    sun<span>/tools/</span>jar</span><br><span></span><br><span>FULL_JRE_RTJAR_INCLUDE_TYPES := \</span><br><span>    com<span>/sun/</span>security<span>/auth/</span>callback/DialogCallbackHandler$<span>$1</span>.class \</span><br><span>    com<span>/sun/</span>security<span>/auth/</span>callback/DialogCallbackHandler$<span>$2</span>.class \</span><br><span>    com<span>/sun/</span>security<span>/auth/</span>callback/DialogCallbackHandler$<span>$Action</span>.class \</span><br><span>    com<span>/sun/</span>security<span>/auth/</span>callback/DialogCallbackHandler$<span>$ConfirmationInfo</span>.class \</span><br><span>    com<span>/sun/</span>security<span>/auth/</span>callback/DialogCallbackHandler.class \</span><br><span>    javax<span>/annotation/</span>*.class \</span><br><span>    javax<span>/management/</span>remote<span>/rmi/</span>_RMIConnectionImpl_Tie.class \</span><br><span>    javax<span>/management/</span>remote<span>/rmi/</span>_RMIConnection_Stub.class \</span><br><span>    javax<span>/management/</span>remote<span>/rmi/</span>_RMIServerImpl_Tie.class \</span><br><span>    javax<span>/management/</span>remote<span>/rmi/</span>_RMIServer_Stub.class \</span><br><span>    javax<span>/rmi/</span>*.class</span><br><span></span><br><span>FULL_JRE_RTJAR_EXCLUDE_TYPES :=</span><br><span></span><br><span>FULL_JRE_INCLUDE_METAINF_SERVICES := \</span><br><span>    META-INF<span>/services/</span>com.sun.tools.internal.ws.wscompile.Plugin \</span><br><span>    META-INF<span>/services/</span>com.sun.tools.internal.xjc.Plugin \</span><br><span>    META-INF<span>/services/</span>javax.print.PrintServiceLookup \</span><br><span>    META-INF<span>/services/</span>javax.print.StreamPrintServiceFactory \</span><br><span>    META-INF<span>/services/</span>javax.sound.midi.spi.MidiDeviceProvider \</span><br><span>    META-INF<span>/services/</span>javax.sound.midi.spi.MidiFileReader \</span><br><span>    META-INF<span>/services/</span>javax.sound.midi.spi.MidiFileWriter \</span><br><span>    META-INF<span>/services/</span>javax.sound.midi.spi.SoundbankReader \</span><br><span>    META-INF<span>/services/</span>javax.sound.sampled.spi.AudioFileReader \</span><br><span>    META-INF<span>/services/</span>javax.sound.sampled.spi.AudioFileWriter \</span><br><span>    META-INF<span>/services/</span>javax.sound.sampled.spi.FormatConversionProvider \</span><br><span>    META-INF<span>/services/</span>javax.sound.sampled.spi.MixerProvider \</span><br><span>    META-INF<span>/services/</span>sun.java2d.cmm.PCMM \</span><br><span>    META-INF<span>/services/</span>sun.java2d.pipe.RenderingEngine</span><br></pre></td></tr></tbody></table>

生成tools.jar包的makefile文件是：文件名为：/openjdk/jdk/make/CreateJars.gmk，内容如下：

<table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br><span>9</span><br><span>10</span><br><span>11</span><br><span>12</span><br><span>13</span><br><span>14</span><br><span>15</span><br><span>16</span><br><span>17</span><br><span>18</span><br><span>19</span><br><span>20</span><br><span>21</span><br><span>22</span><br><span>23</span><br><span>24</span><br><span>25</span><br><span>26</span><br><span>27</span><br><span>28</span><br><span>29</span><br><span>30</span><br><span>31</span><br><span>32</span><br><span>33</span><br><span>34</span><br><span>35</span><br><span>36</span><br><span>37</span><br><span>38</span><br><span>39</span><br><span>40</span><br><span>41</span><br><span>42</span><br><span>43</span><br><span>44</span><br><span>45</span><br><span>46</span><br><span>47</span><br><span>48</span><br><span>49</span><br><span>50</span><br><span>51</span><br><span>52</span><br><span>53</span><br><span>54</span><br><span>55</span><br><span>56</span><br><span>57</span><br><span>58</span><br><span>59</span><br><span>60</span><br><span>61</span><br><span>62</span><br><span>63</span><br><span>64</span><br><span>65</span><br><span>66</span><br><span>67</span><br><span>68</span><br><span>69</span><br><span>70</span><br><span>71</span><br><span>72</span><br><span>73</span><br><span>74</span><br><span>75</span><br><span>76</span><br><span>77</span><br><span>78</span><br><span>79</span><br><span>80</span><br><span>81</span><br><span>82</span><br><span>83</span><br><span>84</span><br><span>85</span><br><span>86</span><br><span>87</span><br><span>88</span><br><span>89</span><br><span>90</span><br><span>91</span><br><span>92</span><br><span>93</span><br><span>94</span><br><span>95</span><br><span>96</span><br><span>97</span><br><span>98</span><br><span>99</span><br><span>100</span><br><span>101</span><br><span>102</span><br><span>103</span><br><span>104</span><br><span>105</span><br><span>106</span><br><span>107</span><br><span>108</span><br><span>109</span><br><span>110</span><br><span>111</span><br><span>112</span><br><span>113</span><br><span>114</span><br><span>115</span><br><span>116</span><br><span>117</span><br><span>118</span><br><span>119</span><br><span>120</span><br><span>121</span><br><span>122</span><br><span>123</span><br><span>124</span><br><span>125</span><br><span>126</span><br><span>127</span><br><span>128</span><br><span>129</span><br><span>130</span><br><span>131</span><br><span>132</span><br><span>133</span><br><span>134</span><br><span>135</span><br><span>136</span><br><span>137</span><br><span>138</span><br><span>139</span><br><span>140</span><br><span>141</span><br><span>142</span><br><span>143</span><br><span>144</span><br><span>145</span><br><span>146</span><br><span>147</span><br><span>148</span><br><span>149</span><br><span>150</span><br><span>151</span><br><span>152</span><br><span>153</span><br><span>154</span><br><span>155</span><br><span>156</span><br><span>157</span><br></pre></td><td><pre><span>#声明rt排除的范围</span><br><span># Full JRE <span>exclude</span> list <span>for</span> rt.jar and resources.jar</span><br><span># <span>This</span> value should <span>exclude</span> types destined <span>for</span> jars other than rt.jar and resources.jar.</span><br><span># When building a Profile <span>this</span> value augments the profile specific exclusions</span><br><span>RT_JAR_EXCLUDES += \</span><br><span>    com<span>/sun/</span>codemodel \</span><br><span>    com<span>/sun/</span>crypto/provider \</span><br><span>    com<span>/sun/i</span>stack<span>/internal/</span>tools \</span><br><span>    com<span>/sun/</span>jarsigner \</span><br><span>    com<span>/sun/</span>java/accessibility \</span><br><span>    com<span>/sun/</span>javadoc \</span><br><span>    com<span>/sun/</span>jdi \</span><br><span>    com<span>/sun/</span>net<span>/ssl/i</span>nternal/ssl \</span><br><span>    com<span>/sun/</span><span>source</span> \</span><br><span>    com<span>/sun/</span>tools \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>dtdparser \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>rngom \</span><br><span>    com<span>/sun/</span>xml<span>/internal/</span>xsom \</span><br><span>    javax/crypto \</span><br><span>    javax<span>/swing/</span>AbstractButtonBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>beaninfo \</span><br><span>    javax<span>/swing/</span>BoxBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JAppletBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JButtonBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JCheckBoxBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JCheckBoxMenuItemBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JColorChooserBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JComboBoxBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JComponentBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JDesktopPaneBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JDialogBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JEditorPaneBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JFileChooserBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JFormattedTextFieldBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JFrameBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JInternalFrameBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JLabelBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JLayeredPaneBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JListBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JMenuBarBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JMenuBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JMenuItemBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JOptionPaneBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JPanelBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JPasswordFieldBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JPopupMenuBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JProgressBarBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JRadioButtonBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JRadioButtonMenuItemBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JScrollBarBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JScrollPaneBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JSeparatorBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JSliderBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JSpinnerBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JSplitPaneBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JTabbedPaneBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JTableBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JTextAreaBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JTextFieldBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JTextPaneBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JToggleButtonBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JToolBarBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JTreeBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>JWindowBeanInfo.<span>class</span> \</span><br><span>    javax<span>/swing/</span>SwingBeanInfoBase.<span>class</span> \</span><br><span>    javax<span>/swing/</span>text/JTextComponentBeanInfo.<span>class</span> \</span><br><span>    META-INF<span>/services/</span>com.sun.jdi.connect.Connector \</span><br><span>    META-INF<span>/services/</span>com.sun.jdi.connect.spi.TransportService \</span><br><span>    META-INF<span>/services/</span>com.sun.tools.attach.spi.AttachProvider \</span><br><span>    META-INF<span>/services/</span>com.sun.tools.xjc.Plugin \</span><br><span>    META-INF<span>/services/</span>sun.net.spi.nameservice.NameServiceDescriptor \</span><br><span>    org<span>/relaxng/</span>datatype \</span><br><span>    sun<span>/awt/</span>HKSCS.<span>class</span> \</span><br><span>    sun<span>/awt/m</span>otif/X11GB2312.<span>class</span> \</span><br><span>    sun<span>/awt/m</span>otif/X11GB2312\$$$$Decoder.<span>class</span> \</span><br><span>    sun<span>/awt/m</span>otif/X11GB2312\$$$$Encoder.<span>class</span> \</span><br><span>    sun<span>/awt/m</span>otif/X11GBK.<span>class</span> \</span><br><span>    sun<span>/awt/m</span>otif/X11GBK\$$$$Encoder.<span>class</span> \</span><br><span>    sun<span>/awt/m</span>otif/X11KSC5601.<span>class</span> \</span><br><span>    sun<span>/awt/m</span>otif/X11KSC5601\$$$$Decoder.<span>class</span> \</span><br><span>    sun<span>/awt/m</span>otif/X11KSC5601\$$$$Encoder.<span>class</span> \</span><br><span>    sun/jvmstat \</span><br><span>    sun<span>/net/</span>spi<span>/nameservice/</span>dns \</span><br><span>    sun<span>/nio/</span>cs/ext \</span><br><span>    sun<span>/rmi/</span>rmic \</span><br><span>    sun<span>/security/</span>ec \</span><br><span>    sun<span>/security/i</span>nternal \</span><br><span>    sun<span>/security/m</span>scapi \</span><br><span>    sun<span>/security/</span>pkcs11 \</span><br><span>    sun<span>/security/</span>provider/Sun.<span>class</span> \</span><br><span>    sun<span>/security/</span>rsa/SunRsaSign.<span>class</span> \</span><br><span>    sun<span>/security/</span>ssl \</span><br><span>    sun<span>/security/</span>tools/jarsigner \</span><br><span>    sun<span>/swing/</span>BeanInfoUtils.<span>class</span> \</span><br><span>    sun<span>/text/</span>resources/cldr \</span><br><span>    sun<span>/tools/</span>asm \</span><br><span>    sun<span>/tools/</span>attach \</span><br><span>    sun<span>/tools/</span>java \</span><br><span>    sun<span>/tools/</span>javac \</span><br><span>    sun<span>/tools/</span>jcmd \</span><br><span>    sun<span>/tools/</span>jconsole \</span><br><span>    sun<span>/tools/</span>jinfo \</span><br><span>    sun<span>/tools/</span>jmap \</span><br><span>    sun<span>/tools/</span>jps \</span><br><span>    sun<span>/tools/</span>jstack \</span><br><span>    sun<span>/tools/</span>jstat \</span><br><span>    sun<span>/tools/</span>jstatd \</span><br><span>    sun<span>/tools/</span>native2ascii \</span><br><span>    sun<span>/tools/</span>serialver \</span><br><span>    sun<span>/tools/</span>tree \</span><br><span>    sun<span>/tools/u</span>til \</span><br><span>    sun<span>/util/</span>cldr/CLDRLocaleDataMetaInfo.<span>class</span> \</span><br><span>    sun<span>/util/</span>resources/cldr \</span><br><span>    $(LOCALEDATA_INCLUDES) \</span><br><span>    com<span>/oracle/</span>jrockit/jfr \</span><br><span>    oracle<span>/jrockit/</span>jfr \</span><br><span>    jdk/jfr</span><br><span></span><br><span># 在jdk编译输出classes目录下查询所有定义依赖的文件</span><br><span># <span>Find</span> all files in the classes dir to use as <span>dependencies</span>. <span>This</span> could be more fine granular.</span><br><span>ALL_FILES_IN_CLASSES := $(<span>call</span> not-containing, _the., $(filter-out %javac_state, \</span><br><span>    $(<span>call</span> CacheFind, $(JDK_OUTPUTDIR)/classes)))</span><br><span></span><br><span>RT_JAR_MANIFEST_FILE := $(IMAGES_OUTPUTDIR)<span>/lib$(PROFILE)/</span>_the.rt.jar_manifest</span><br><span>RESOURCE_JAR_MANIFEST_FILE := $(IMAGES_OUTPUTDIR)<span>/lib$(PROFILE)/</span>_the.resources.jar_manifest</span><br><span></span><br><span>$(RT_JAR_MANIFEST_FILE): $(MAINMANIFEST) $(BEANMANIFEST)</span><br><span>$(MKDIR) -p $(@D)</span><br><span>$(RM) $@ $@.tmp</span><br><span>$(SED) -e <span>"s#@@RELEASE@@#$(RELEASE)#"</span> \</span><br><span>    -e <span>"s#@@COMPANY_NAME@@#$(COMPANY_NAME)#"</span> \</span><br><span>    $(MAINMANIFEST) &gt;&gt; $@.tmp</span><br><span>$(ECHO) &gt;&gt; $@.tmp</span><br><span>$(CAT) $(BEANMANIFEST) &gt;&gt; $@.tmp</span><br><span>$(MV) $@.tmp $@</span><br><span></span><br><span></span><br><span># <span>This</span> defines a target-specific variables to make the shell logic easier to see.</span><br><span># We need to <span>find</span> the Version.<span>class</span> <span>file</span> <span>for</span> the profile currently being built</span><br><span>$(IMAGES_OUTPUTDIR)<span>/lib$(PROFILE)/</span>rt.jar: \</span><br><span>    CLASS_FILE = $(<span>if</span> $(PROFILE), $(strip $(foreach <span>class</span>, $(PROFILE_VERSION_CLASS_TARGETS), $(<span>if</span> $(findstring $(PROFILE), $(<span>class</span>)), $(<span>class</span>)))), NO_SUCH_FILE)</span><br><span># <span>This</span> is the real target</span><br><span>$(IMAGES_OUTPUTDIR)<span>/lib$(PROFILE)/</span>rt.jar: $(IMAGES_OUTPUTDIR)<span>/lib$(PROFILE)/</span>_the.rt.jar.contents $(RT_JAR_MANIFEST_FILE) $(PROFILE_VERSION_CLASS_TARGETS) $(BEANLESS_CLASSES_TARGETS)</span><br><span>$(ECHO) Creating rt.jar $(PROFILE) Compressed=$(COMPRESS_JARS)</span><br><span>$(MKDIR) -p $(@D)</span><br><span>$(RM) $@ $@.tmp</span><br><span>$(CD) $(JDK_OUTPUTDIR)/classes &amp;&amp; \</span><br><span>$(JAR) $(RT_JAR_CREATE_OPTIONS) $@.tmp $(RT_JAR_MANIFEST_FILE) \</span><br><span>    @$(IMAGES_OUTPUTDIR)<span>/lib$(PROFILE)/</span>_the.rt.jar.contents &amp;&amp; \</span><br><span><span>if</span> [ -f $(CLASS_FILE) ]; then \</span><br><span>  $(ECHO) Updating rt.jar $(PROFILE) &amp;&amp; \</span><br><span>  $(CD) $(patsubst %$(VERSION_CLASS_PATH), %, $(CLASS_FILE)) &amp;&amp; \</span><br><span>  $(JAR) $(RT_JAR_UPDATE_OPTIONS) $@.tmp $(VERSION_CLASS_PATH); \</span><br><span>  $(CD) $(BEANLESS_CLASSES) &amp;&amp; \</span><br><span>  $(JAR) $(RT_JAR_UPDATE_OPTIONS) $@.tmp $(CLASSES_TO_DEBEAN); \</span><br><span>fi</span><br><span>$(MV) $@.tmp $@</span><br></pre></td></tr></tbody></table>

#### [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#jconsole-jar)jconsole.jar

jconsole.jar包在jdk的lib目录下，是一个Java监视和管理控制台的客户端程序，由javax swing开发。  
jsoncole可以附加本地java进程，通过api查询方式或者使用jms协议查询java虚拟机一些观测数据。  
jconsole.jar主要组成由jdk/src/share/classes/sun/tools/jconsole、  
jdk/src/share/classes/com/sun/tools/jconsole目录下文件组成。

jdk本身提供了2中方式，一种是bin目录下的jconsole程序，另外一种就是lib下的jconsole.jar包。  
bin下的jsoncole直接运行，启动打开jconsole的main入口， lib下的jsoncole.jar需要使用java -jar jsoncole.jar运行。

<table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br></pre></td><td><pre><span>$(eval $(<span>call</span> SetupArchive,BUILD_JCONSOLE_JAR, , \</span><br><span>    SRCS := $(JDK_OUTPUTDIR)/classes, \</span><br><span>    SUFFIXES := .<span>class</span> .gif .png .properties, \</span><br><span>    <span>INCLUDES</span> := sun<span>/tools/</span>jconsole com<span>/sun/</span>tools/jconsole, \</span><br><span>    JARMAIN := sun.tools.jconsole.JConsole, \</span><br><span>    JAR := $(IMAGES_OUTPUTDIR)<span>/lib/</span>jconsole.jar, \</span><br><span>    SKIP_METAINF := <span>true</span>))</span><br></pre></td></tr></tbody></table>

#### [](https://www.lehoon.cn/backend/2018/12/06/openjdk-makefile-note.html#dt-jar)dt.jar

dt.jar包在jdk的lib目录下，提供运行时图形界面运行时环境，在使用java swing、awt开发的时候必须依赖该库。  
dt.jar主要组成由

<table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br></pre></td><td><pre><span>jdk<span>/src/</span>share<span>/classes/</span>javax<span>/swing/</span></span><br><span>jdk<span>/src/</span>share<span>/classes/</span>sun<span>/swing/</span></span><br><span>jdk<span>/make/</span>data<span>/swingbeaninfo/</span>javax<span>/swing/</span>SwingBeanInfoBase.java</span><br><span>jdk<span>/make/</span>data<span>/swingbeaninfo/</span>sun<span>/swing/</span>BeanInfoUtils.java</span><br></pre></td></tr></tbody></table>

文件组成。

排除jdk/src/share/classes/javax/plaf目录下文件。

<table><tbody><tr><td><pre><span>1</span><br><span>2</span><br><span>3</span><br><span>4</span><br><span>5</span><br><span>6</span><br><span>7</span><br><span>8</span><br></pre></td><td><pre><span>$(eval $(<span>call</span> SetupArchive,BUILD_SWINGBEANS_JAR, , \</span><br><span>    SRCS := $(JDK_OUTPUTDIR)/classes, \</span><br><span>    SUFFIXES := BeanInfo.<span>class</span> .gif, \</span><br><span>    <span>INCLUDES</span> := javax<span>/swing sun/</span>swing, \</span><br><span>    EXCLUDES := javax<span>/swing/</span>plaf, \</span><br><span>    EXTRA_FILES := javax<span>/swing/</span>SwingBeanInfoBase.<span>class</span> sun<span>/swing/</span>BeanInfoUtils.<span>class</span>, \</span><br><span>    JAR := $(IMAGES_OUTPUTDIR)<span>/lib/</span>dt.jar, \</span><br><span>    SKIP_METAINF := <span>true</span>))</span><br></pre></td></tr></tbody></table>

[**<**

linux使用记录笔记

](https://www.lehoon.cn/orther/2018/12/27/linux-using-note.html)[

OpenJdk1.8笔记--java启动流程

**>**](https://www.lehoon.cn/orther/2018/11/27/openjdk-startup-note.html)
